<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>üßæ ‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</title>
<link rel="stylesheet" href="pos.css">
</head>
<body class="customer-bg">

<div class="customer-screen">

  <h1 class="shop-name" id="shopName">‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</h1>

  <div class="bill-card">
    <h2>üßæ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
    <div id="billList"></div>

    <div class="total">
      ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
      <span id="total">0</span> ‡∏ø
    </div>
  </div>

  <div class="qr-card">
    <h2>üì± ‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h2>
    <img id="qrImg" src="" alt="QR Payment">
    <p class="hint">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö BCEL / OnePay / PromptPay</p>
  </div>

</div>

<script>
function loadBill(){
  const cart = JSON.parse(localStorage.getItem("POS_CART")) || {};
  const total = localStorage.getItem("POS_TOTAL") || 0;
  const shop  = JSON.parse(localStorage.getItem("SHOP_INFO")) || {};

  document.getElementById("shopName").innerText = shop.name || "‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤";
  document.getElementById("total").innerText = total;

  const list = document.getElementById("billList");
  list.innerHTML = "";

  Object.values(cart).forEach(p=>{
    list.innerHTML += `
      <div class="bill-row">
        <span>${p.name} x${p.qty}</span>
        <b>${p.price * p.qty} ‡∏ø</b>
      </div>
    `;
  });

  // QR (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ‚Äî ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô QR ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏î‡πâ)
  document.getElementById("qrImg").src =
    `https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=PAY:${total}`;
}

setInterval(loadBill, 800); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
</script>

</body>
</html>